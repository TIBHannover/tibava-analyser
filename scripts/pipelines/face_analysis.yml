- pipeline: face_analysis
  inputs:
    - video_id
  plugins:
    - plugin: insightface_video_detector_torch
      parameters:
        fps: 5
        det_thresh: 0.5
        nms_thresh: 0.4
        input_size: [640, 640]
      requires:
        video: video_id
      provides:
        images: faceimages
        bboxes: bboxes
        kpss: kpss
        faces: faces
    - plugin: deepface_emotion
      requires:
        images: faceimages
        faces: faces
      provides:
        probs: emotions
    - plugin: insightface_video_feature_extractor
      requires:
        video: video_id
        kpss: kpss
        faces: faces
      provides:
        features: facialfeatures
    - plugin: insightface_video_gender_age_calculator
      requires:
        video: video_id
        bboxes: bboxes
        faces: faces
      provides:
        ages: ages
        genders: genders
  outputs:
    - faces
    - bboxes
    - kpss
    - facialfeatures
    - emotions
    - ages
    - genders
- pipeline: face_to_camera_size
  inputs:
    - video_id
  plugins:
    - plugin: insightface_video_detector_torch
      parameters:
        fps: 5
        det_thresh: 0.5
        nms_thresh: 0.4
        input_size: [640, 640]
      requires:
        video: video_id
      provides:
        bboxes: bboxes
    - plugin: insightface_facesize
      parameters:
        reduction: max
      requires:
        bboxes: bboxes
      provides:
        probs: camerasize_probs
        facesizes: facessizes
  outputs:
    - facessizes
    - camerasize_probs
